# n8n Workflows

این پوشه شامل ورک‌فلوهای اتوماسیون نوشته‌شده برای n8n است. برای استفاده از هر فایل JSON، مراحل زیر را انجام دهید:

1. سرویس n8n را با docker-compose یا به‌صورت جداگانه اجرا کنید. در `docker-compose.yml`، سرویس n8n در پورت 5678 در دسترس است.
2. وارد رابط کاربری n8n شوید (`http://localhost:5678`).
3. از منوی Import، فایل JSON موردنظر (مثلاً `publish_article.json`) را بارگذاری کنید.
4. متغیرهای محیطی مانند `CMS_API_URL`, `CMS_API_TOKEN` و `API_URL` را مطابق با پیکربندی خود تنظیم کنید.
5. ورک‌فلو را فعال کنید تا هنگام دریافت وب‌هوک رویداد، فرآیند انتشار به‌طور خودکار اجرا شود.

### publish_article.json

این ورک‌فلو سه گره دارد:

1. **Webhook**: رویداد «publish-article» را دریافت می‌کند و داده‌هایی نظیر `title`, `body` و `requestId` را می‌گیرد.
2. **Publish to CMS**: با استفاده از API CMS، مقاله را منتشر می‌کند. آدرس URL و توکن دسترسی از متغیرهای محیطی گرفته می‌شود.
3. **Update Status**: پس از انتشار موفق، یک درخواست POST به سرویس بک‌اند می‌فرستد تا وضعیت درخواست محتوا به «published» تغییر یابد.

در صورت نیاز می‌توانید گره‌های دیگری (مانند ارسال ایمیل یا ثبت در CRM) به این ورک‌فلو اضافه کنید.